#!/usr/bin/env sai-run

reference:
  fs require('fs')
  readline require('readline')
  stream require('stream')
  
object Test main

instance:
  pass empty
  fail empty
  ids blank

Instantiate task

  //@AnalyseParseTrace

  set tests to list
    Scope
    Loops
    Generators
    Promises
    Literals
    Syntax
    Comps
    RValues
    Operators
    Precedence
    Constructs
    Functions
    SetStatement
    Reference
    CompOrderOps
    Inheritance
    Pipers

  set startTime new ~Date
  ply tests
    try
      set suite to create it @
      suite.Execute
    catch
      debug error
      push'd fail "Could not execute tests in ${it}"
      
  set endTime new ~Date
  debug 'Test time ${endTime-startTime}ms.'
  
  if @fail.length
    debug 'FAILED'
    ply @fail
      debug 'FAIL: ${it}'
    ~process.exit 1
  else
    debug 'SUCCESS'
